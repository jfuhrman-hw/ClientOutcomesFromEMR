<?xml version="1.0"?>
<DTS:Executable xmlns:DTS="www.microsoft.com/SqlServer/Dts"
  DTS:refId="Package"
  DTS:CreationDate="12/13/2019 3:26:02 PM"
  DTS:CreationName="Microsoft.Package"
  DTS:CreatorComputerName="AZW-PXX-JP12"
  DTS:CreatorName="Prod\p-kchin"
  DTS:DTSID="{DF6C348D-4F75-4D48-BB57-9EB102467537}"
  DTS:ExecutableType="Microsoft.Package"
  DTS:LastModifiedProductVersion="15.0.1100.123"
  DTS:LocaleID="1033"
  DTS:ObjectName="FactEncounterEvent_VisitCategory"
  DTS:PackageType="5"
  DTS:VersionBuild="172"
  DTS:VersionGUID="{372CE30B-8C2D-4A3C-A0C5-1460D362A911}">
  <DTS:Property
    DTS:Name="PackageFormatVersion">8</DTS:Property>
  <DTS:ConnectionManagers>
    <DTS:ConnectionManager
      DTS:refId="Package.ConnectionManagers[asazure://westus.asazure.windows.net/azwphaas01.POC]"
      DTS:CreationName="MSOLAP100"
      DTS:DTSID="{EDFFE2E4-EF34-4220-AA94-E7D3FB382EB5}"
      DTS:ObjectName="asazure://westus.asazure.windows.net/azwphaas01.POC">
      <DTS:ObjectData>
        <DTS:ConnectionManager
          DTS:ConnectionString="Data Source=asazure://westus.asazure.windows.net/azwphaas01;Initial Catalog=POC;Provider=MSOLAP.8;Impersonation Level=Impersonate;" />
      </DTS:ObjectData>
    </DTS:ConnectionManager>
  </DTS:ConnectionManagers>
  <DTS:Variables />
  <DTS:Executables>
    <DTS:Executable
      DTS:refId="Package\Set Visit Category Types part 1a"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{4073BF04-B413-4AB5-9A30-25DCD479ADB5}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Set Visit Category Types part 1a"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{C00F5F91-4855-41BC-A28F-D3BCF3559DE6}"
          SQLTask:SqlStatementSource="select distinct([EncounterKey]) as EncounterKey&#xA; into #EncounterKeys&#xA;from [dbo].[FactEncounterEvent_v2]&#xA;where (VisitCategoryKey = 8&#xA;or VisitCategoryKey is null)&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7 &#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 27 &#xA;and DepartmentKey in (5222,5443,5261,5134,5029,5046,5405,6331,5973,5141,5217,5353,5016,5221,5410,4933,5359,5227,6321,5140,5235,4988,5975,5336,6785,5283,4967,5352,6342,6416,4934,9138,5906,5197,6793,5293)&#xA;;&#xA;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 27 &#xA;and DepartmentKey in (4637,4955,4118,5255,4166,4241,4130,5387,4446,4505,5980,4381,5349,4250,4474,4438,5466,4445,4914)&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 57 &#xA;and DepartmentKey in (4655,5956,4381,4505,4446)&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 3&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 34 &#xA;and DepartmentKey in (5357)&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 3&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 38 &#xA;and DepartmentKey in (1109)&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 2&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 33 &#xA;and DepartmentKey in (5357,4655,5222,5336,5345,5410,5029,5949,4250,4166,4446,4381,4474,4823)&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 11 &#xA;and DepartmentKey in (5336,5222,5029,4655,4933,4381,4823,5163,4474)&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 2&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 37 &#xA;and DepartmentKey in (10,100,1000,1003,1004,1005,1006,1007,1008,1009,101,1011,1012,1013,1014,1015,1016,1017,1019,102,1020,1021,1022,1023,1026,1027,10)&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7 &#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 27 &#xA;and DepartmentKey in (1015,1020,1031,1032,1036,1043,1044,1046,1058,1061,1076,1077,1082,1092,1097,1103,1106,111,1111,1112,1115,1125,113,1132,1139,1147)&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7 &#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 3&#xA;and DepartmentKey in (1000,1003,1005,1006,101,1014,1016,1017,1021,1022,1026,1028,1029,1033,1035,1036,1037,104,1040,1041,1045,1053,1055,106,1062,1066)&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7 &#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 65&#xA;and DepartmentKey in (4739,5442,5206,5339,5254,4557,5257,5175,5028,4878,4979,4879,5321,5152,4432,4500,&#xA;5139,4435,4506,5157,5393,4255,4849,4111,4329,5412,4810,4825,5342,4137,5182,4371,4415,5369,5309,4322,4892,4526,4878,4979,5200,5395,5218,4571,4809&#xA;,18,22,46,59,61,78,89,97,106,108,119,123,125,130,134,151,152,156,167,179&#xA;,186,207,212,216,225,230,245,260,261,284,299,305,306,340,407,408,414,426&#xA;,434,436,439,477,525,526,528,529,541,553,561,562,567,568,580,583,594,602&#xA;,613,645,647,648,652,658,667,674,682,683,700,726,727,739,746,749,751,777&#xA;,779,792,820,853,855,863,871,893,909,914,954,959,960,973,985,1022,1027,1028&#xA;,1035,1041,1069,1103,1105,1110,1126,1133,1154,1157,1160,1165,1173,1186,1187&#xA;,1198,1200,1202,1203,1204,1219,1261,1270,1273,1277,1285,1299,1309,1318,1335&#xA;,1340,1343,1348,1350,1353,1359,1380,1386,1414,1419,1423,1430,1431,1438,1454&#xA;,1456,1457,1459,1478,1492,1505,1520,1555,1560,1568,1574,1579,1598,1599,1604&#xA;,1606,1610,1625,1626,1628,1640,1659,1666,1693,1702,1706,1707,1711,1717,1718&#xA;,1730,1736,1758,1759,1767,1776,1779,1790,1795,1798,1814,1819,1822,1823,1839&#xA;,1865,1880,1895,1898,1899,1904,1921,1947,1952,1961,1965,1994,2032,2036,2042&#xA;,2043,2048,2050,2054,2064,2077,2101,2111,2140,2148,2150,2164,2168,2190,2199&#xA;,2256,2274,2278,2280,2305,2312,2314,2318,2325,2332,2337,2360,2376,2379,2406&#xA;,2417,2420,2425,2457,2458,2459,2468,2470,2473,2475,2488,2508,2512,2549,2555&#xA;,2569,2578,2584,2604,2614,2615,2616,2626,2628,2630,2638,2651,2670,2673,2681&#xA;,2688,2704,2716,2717,2722,2743,2751,2764,2766,2769,2784,2794,2795,2807,2811&#xA;,2815,2837,2876,2879,2913,2914,2917,2932,2975,2977,2978,2980,2987,3007,3015&#xA;,3016,3044,3051,3053,3054,3076,3087,3091,3101,3104,3114,3145,3156,3161,3170&#xA;,3174,3177,3179,3200,3212,3229,3231,3247,3259,3265,3275,3277,3288,3291,3305&#xA;,3344,3345,3351,3361,3370,3378,3419,3502,3512,3518,3528,3533,3534,3538,3539&#xA;,3562,3567,3576,3578,3580,3582,3591,3603,3628,3632,3638,3649,3686,3731,3742&#xA;,3749,3805,3844,3877,3937,4023,4081,4099,4100,4116,4122,4132,4139,4149,4154&#xA;,4156,4201,4208,4215,4226,4231,4235,4256,4273,4284,4286,4292,4299,4311,4334&#xA;,4336,4355,4356,4358,4362,4374,4382,4390,4399,4410,4413,4433,4440,4443,4452&#xA;,4477,4479,4491,4497,4517,4527,4541,4546,4547,4584,4590,4593,4602,4608,4630&#xA;,4631,4636,4655,4678,4690,4695,4712,4724,4732,4738,4759,4761,4765,4800,4803&#xA;,4821,4850,4861,4870,4881,4882,4884,4891,4927,4933,4934,4948,4953,4967,4975&#xA;,4988,4993,5016,5029,5031,5042,5044,5046,5067,5088,5089,5090,5091,5101,5107&#xA;,5131,5134,5135,5140,5141,5180,5185,5189,5192,5195,5197,5217,5219,5221,5222&#xA;,5224,5226,5227,5235,5247,5253,5256,5261,5274,5283,5293,5304,5308,5315,5319&#xA;,5330,5333,5336,5345,5347,5352,5353,5357,5359,5367,5373,5376,5381,5385,5392&#xA;,5396,5397,5401,5405,5410,5424,5426,5443,5453,5461,5474,5478,5484,5485,5499&#xA;,5507,5515,5528,5530,5546,5551,5570,5590,5619,5624,5630,5637,5645,5650,5660&#xA;,5676,5693,5699,5774,5780,5787,5790,5808,5818,5822,5831,5840,5849,5886,5902&#xA;,5903,5905,5906,5907,5918,5949,5953,5956,5963,5972,5973,5975,5982,5997,5999&#xA;,6005,6024,6088,6115,6140,6246,6259,6294,6310,6315,6321,6330,6331,6337,6341&#xA;,6342,6344,6349,6352,6361,6364,6376,6387,6407,6411,6412,6414,6416,6417,6419&#xA;,6420,6421,6422,6423,6425,6432,6433,6437,6457,6475,6538,6553,6579,6601,6631&#xA;,6639,6684,6688,6693,6697,6710,6727,6738,6739,6751,6752,6756,6781,6785,6788&#xA;,6793,6803,6817,6819,6830,6846,6847,6859,6863,6866,6876,6880,6884,6888,6889&#xA;,6890,6898,6903,6933,6938,6950,6987,7014,7030,7047,7049,7056,7090,7100,7135&#xA;,7138,7197,7205,7213,7233,7252,7253,7276,7284,7292,7337,7382,7395,7400,7401&#xA;,7427,7445,7456,7464,7499,7505,7541,7625,7683,7696,7749,7760,7785,7866,7872&#xA;,7874,7882,7886,7912,7948,8041,8061,8072,8096,8108,8134,8162,8178,8194,8207&#xA;,8243,8298,8310,8323,8353,8369,8469,8470,8482,8504,8565,8574,8603,8607,8637&#xA;,8644,8681,8692,8704,8726,8743,8744,8753,8797,8836,8870,8917,8933,8962,8970&#xA;,9031,9060,9080,9115,9125,9130,9132,9133,9134,9138,9139,9141,9145,9149,9154&#xA;,9156,9160,9175,9177,9178,9194,9201,9209,9210,9211,9212,9219,9223,9225,9228&#xA;,9229,9236,9240,9241,9244,9248,9253,9259,9269,9278,9280,9289,9297,9316,9318&#xA;,9319,9348,9351,9354,9361,9365,9366,9368,9372,9389,9391,9396,9397,9403,9404&#xA;,9410,9411,9414,9421,9425,9428,9451,9486,9488,9512,9522,9537,9547,9584,9603)&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7 &#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 83&#xA;and DepartmentKey in (4748,4739)&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 9 &#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 166&#xA;and DepartmentKey in (3406)&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 143&#xA;and DepartmentKey in (5343,4191,5392)&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 150&#xA;and DepartmentKey in (5341,&#xA;1005,1055,1086,1091,1098,1119,1150,1171,1172,118,1199,120,121,122,1225,&#xA;1228,1238,1256,126,127,1280,132,1362,14,1445,1460,1480,1490,1494,1525,&#xA;1532,1550,1552,1587,1619,1629,1645,1672,1691,1703,1704,1731,1755,1781,&#xA;1793,1812,1827,1852,1876,1878,1889,190,1928,1933,1940,1991,1993,1997,201,&#xA;2016,203,2088,2098,2105,2132,2136,2147,2154,2170,2184,2195,2205,2206,2265,&#xA;2279,2322,2327,2329,2370,238,2380,2389,2393,2407,2445,2448,2454,2530,2541,&#xA;2582,2605,2612,2621,2625,263,2687,2696,2728,2733,2771,2800,2818,2851,2877,&#xA;2901,2924,2930,2947,3003,301,3031,3050,3055,3058,3067,3111,3146,3165,3192,&#xA;3251,3266,3282,329,3312,3347,3376,338,3383,3408,3410,3425,3434,3451,346,&#xA;3465,3470,3475,3521,3524,3605,3612,3623,3625,3700,3786,3824,3828,383,3850,&#xA;387,393,3950,3952,4014,4064,4095,4099,4103,4111,4116,4137,4151,4152,4156,&#xA;4161,4167,4179,4183,4187,4221,4229,4231,4234,4237,4243,4244,4247,4255,4264,&#xA;4266,4280,4281,4283,4286,429,4310,4312,432,4321,4323,4329,4331,4342,4352,&#xA;4353,4365,4369,4371,4374,438,4382,4388,4391,4398,4404,&#xA;4413,4414,4415,4426,4432,4434,4435,4437,4500,4506,4510,4521,4541,4551,4557,4559,&#xA;4564,4573,458,4593,4596,4609,461,4616,4636,4652,4655,4656,4667,4672,4680,469,4700,4710,&#xA;4732,4736,4743,475,4750,479,4798,4803,4807,4810,4819,4822,4825,4837,4841,4847,&#xA;4849,4856,4872,4879,4881,4890,4898,4899,4909,4929,4933,4934,4937,4945,4953,4967,&#xA;4969,4985,4988,4990,500,5001,5015,5016,5024,5029,5033,5040,5044,5046,5051,5054,&#xA;5067,5097,5099,511,5115,5124,5125,5134,5136,5139,5140,5141,5152,5155,5157,5158,&#xA;5175,5177,5180,5182,5195,5196,5197,5200,5202,5204,5206,5217,5221,5222,5227,5229,&#xA;5235,5236,5243,5247,5251,5252,5254,5257,5258,5261,5262,5267,5268,527,5270,5271,&#xA;5274,5275,5282,5283,5293,5297,5303,5318,5319,5321,5334,5335,5336,5342,5344,5345,&#xA;5351,5352,5353,5354,5357,5359,5367,5371,5373,5374,5393,5395,5405,5410,5411,5412,&#xA;5421,5442,5443,5444,546,5509,5512,5521,5579,5604,5626,565,5710,5767,5777,5829,5836,&#xA;5875,5879,5889,5894,5903,5905,5906,5907,5917,5927,5936,5945,5947,5949,5956,5963,&#xA;5964,5968,5971,5973,5975,5981,5982,5988,5993,6009,6054,6084,610,6124,618,626,6267,&#xA;6274,6321,6331,6333,6342,6346,6355,6365,6377,6380,6405,6413,6415,6416,6431,6436,6437,&#xA;6439,644,6479,6520,6527,6547,6560,6594,6631,6664,6696,672,6755,6771,6781,6785,6787,&#xA;6793,6798,6803,6805,6825,6829,6901,6913,6955,7012,7013,7050,7051,7058,707,7101,7115,7127,7157,7160,7161,&#xA;7167,7186,7199,7217,7224,723,7230,7258,7269,7294,7297,7309,7328,7345,7360,7364,7367,&#xA;7369,7430,7432,7451,7497,7501,7506,7539,7562,7568,7578,7600,7610,7661,767,774,&#xA;7782,7799,7825,7847,7852,7887,7899,7931,794,7959,7986,7988,7994,8003,8019,803,&#xA;8031,8032,8048,8065,8084,8099,8102,8103,8107,8114,8124,8136,8176,8181,8227,8262,&#xA;8275,8299,8306,8322,8325,8339,8360,8366,8378,8388,8399,8406,8434,8464,8474,8499,&#xA;8564,8592,8609,8658,8665,8698,8729,876,878,8788,881,8818,882,8837,8838,8861,&#xA;8865,8892,8897,8913,8939,8948,8987,8988,8989,899,9004,9014,9021,9048,9071,9081,&#xA;9089,9100,9109,9110,9112,9113,9116,9134,9138,9146,9208,9262,9292,9303,9322,9340,&#xA;9394,9418,9433,9435,9436,9438,9444,9450,9453,9462,9463,9464,9467,9480,9483,9487,&#xA;9494,9495,9496,9501,9509,9513,9535,9550,9555,9558,9562,9566,9569,962,964,971)&#xA;;&#xA;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 56&#xA;and DepartmentKey in (5324&#xA;,1005,1055,1086,1091,1098,1119,1150,1171,1172,118,1199,120,121,122,1225,&#xA;1228,1238,1256,126,127,1280,132,1362,14,1445,1460,1480,1490,1494,1525,1532,1550,1552,1587,1619,1629,1645,1672,1691,1703,1704,&#xA;1731,1755,1781,1793,1812,1827,1852,1876,1878,1889,190,1928,1933,1940,1991,1993,1997,201,2016,203,2088,2098,2105,2132,2136,2147,&#xA;2154,2170,2184,2195,2205,2206,2265,2279,2322,2327,2329,2370,238,2380,2389,2393,2407,2445,2448,2454,2530,2541,2582,2605,2612,&#xA;2621,2625,263,2687,2696,2728,2733,2771,2800,2818,2851,2877,2901,2924,2930,2947,3003,301,3031,3050,3055,3058,3067,3111,3146,&#xA;3165,3192,3251,3266,3282,329,3312,3347,3376,338,3383,3408,3410,3425,3434,3451,346,3465,3470,3475,3521,3524,3605,3612,3623,&#xA;3625,3700,3786,3824,3828,383,3850,387,393,3950,3952,4014,4064,4095,4099,4103,4111,4116,4137,4151,4152,4156,4161,4167,4179,&#xA;4183,4187,4221,4229,4231,4234,4237,4243,4244,4247,4255,4264,4266,4280,4281,4283,4286,429,4310,4312,432,4321,4323,4329,&#xA;4331,4342,4352,4353,4365,4369,4371,4374,438,4382,4388,4391,4398,4404,4413,4414,4415,4426,4432,4434,4435,4437,4500,4506,&#xA;4510,4521,4541,4551,4557,4559,564,4573,458,4593,4596,4609,461,4616,4636,4652,4655,4656,4667,4672,4680,469,4700,4710,4732,&#xA;4736,4743,475,4750,479,4798,4803,4807,4810,4819,4822,4825,4837,4841,4847,4849,4856,4872,4879,4881,4890,4898,4899,4909,4929,&#xA;4933,4934,4937,4945,4953,4967,4969,4985,4988,4990,500,5001,5015,5016,5024,5029,5033,5040,5044,5046,5051,5054,5067,5097,5099,511,&#xA;5115,5124,5125,5134,5136,5139,5140,5141,5152,5155,5157,5158,5175,5177,5180,5182,5195,5196,5197,5200,5202,5204,5206,5217,5221,&#xA;5222,5227,5229,5235,5236,5243,5247,5251,5252,5254,5257,5258,5261,5262,5267,5268,527,5270,5271,5274,5275,5282,5283,5293,&#xA;5297,5303,5318,5319,5321,5334,5335,5336,5342,5344,5345,5351,5352,5353,5354,5357,5359,5367,5371,5373,5374,5393,5395,5405,&#xA;5410,5411,5412,5421,5442,5443,5444,546,5509,5512,5521,5579,5604,5626,565,5710,5767,5777,5829,5836,5875,5879,5889,5894,&#xA;5903,5905,5906,5907,5917,5927,5936,5945,5947,5949,5956,5963,5964,5968,5971,5973,5975,5981,5982,5988,5993,6009,6054,6084,610,&#xA;6124,618,626,6267,6274,6321,6331,6333,6342,6346,6355,6365,6377,6380,6405,6413,6415,6416,6431,6436,6437,6439,644,6479,6520,&#xA;6527,6547,6560,6594,6631,6664,6696,672,6755,6771,6781,6785,6787,6793,6798,6803,6805,6825,6829,6901,6913,6955,7012,7013,7050,&#xA;7051,7058,707,7101,7115,7127,7157,7160,7161,7167,7186,7199,7217,7224,723,7230,7258,7269,7294,7297,7309,7328,7345,7360,7364,7367,&#xA;7369,7430,7432,7451,7497,7501,7506,7539,7562,7568,7578,7600,7610,7661,767,774,7782,7799,7825,7847,7852,7887,7899,7931,794,&#xA;7959,7986,7988,7994,8003,8019,803,8031,8032,8048,8065,8084,8099,8102,8103,8107,8114,8124,8136,8176,8181,8227,8262,8275,&#xA;8299,8306,8322,8325,8339,8360,8366,8378,8388,8399,8406,8434,8464,8474,8499,8564,8592,8609,8658,8665,8698,8729,876,878,&#xA;8788,881,8818,882,8837,8838,8861,8865,8892,8897,8913,8939,8948,8987,8988,8989,899,9004,9014,9021,9048,9071,9081,9089,&#xA;9100,9109,9110,9112,9113,9116,9134,9138,9146,9208,9262,9292,9303,9322,9340,9394,9418,9433,9435,9436,9438,9444,9450,&#xA;9453,9462,9463,9464,9467,9480,9483,9487,9494,9495,9496,9501,9509,9513,9535,9550,9555,9558,9562,9566,9569,962,964,971,&#xA;1027,1035,1126,125,1270,1380,1423,1431,1492,151,1555,1659,1706,1759,1779,1790,1823,1895,1899,1904,2050,2312,2325,2332,2379,&#xA;2417,2470,2488,2584,2638,2704,2716,2811,2975,2987,299,3016,3087,3114,3145,3275,3528,3539,3576,3578,3628,3638,3844,3877,4122,4132,4139,4149,&#xA;434,4362,4440,4477,4547,4690,4759,477,4861,4884,5185,5224,5333,5424,5499,5507,5528,5624,5637,5650,5660,5774,5780,5787,5822,583,5902,594,&#xA;6294,6341,6344,6376,6387,6412,6414,6420,6421,6422,6432,6538,658,6684,6693,6738,6739,674,6752,6756,682,6830,6847,6863,6866,6876,6880,6884,6888,&#xA;6890,6898,6903,6933,6938,6950,6987,7047,7100,7233,7292,7337,7400,7499,7505,7541,7683,7785,7872,7886,792,8041,8061,8096,8108,8194,8298,8369,8504,8565,8603,&#xA;863,8644,8681,8836,893,8962,9060,9115,9125,9141,9154,9194,9201,9210,9228,9229,9236,9241,9269,9280,9316,9319,9351,9391,9396,9428,9522,9603)&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 9 &#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 56&#xA;and DepartmentKey in (5425,4428)&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 161&#xA;and DepartmentKey in (5747,1095,1327,1822,2308,2507,2737,3010,611,623,87)&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 14&#xA;and DepartmentKey in (2428,117,1334,1394,151,1598,162,1668,170,172,1795,1870,1896,1913,1921,1953,1997,2016,2022,2118,2238,2256,2402,2448,2474,2540,2623,&#xA;2670,2713,2886,2891,291,2929,2953,2986,305,3096,3284,3295,3404,3434,3465,3787,3851,3989,400,4019,581,5863,5891,6059,6383,6707,688,773,&#xA;774,813,9584,986,1021,1069,1107,1175,120,121,128,1392,1437,1474,1507,1583,160,1617,1655,167,1688,1710,1711,1728,179,1819,1998,2005,203,&#xA;2062,2159,2216,2279,2285,2335,2340,2347,2413,2457,2468,2489,2490,2500,2512,2636,2693,2704,2871,2892,2968,3016,3170,3248,3302,3424,349,357,&#xA;3605,3716,3827,3938,3946,3988,4037,457,501,5865,588,5893,611,636,641,669,731,753,794,857,1022,106,1187,1189,1193,1207,1210,1224,1264,1309,&#xA;1310,1327,1353,139,1395,1429,145,1500,1548,1649,1678,1692,1735,1915,1986,1994,2030,2078,2083,2090,2113,2161,2191,2203,2247,2308,2343,2397,2420,&#xA;2466,2511,2589,260,262,2645,2682,2699,2707,2717,2761,2792,2807,2816,2903,293,2941,2978,2985,3010,3043,3055,3073,3095,3282,3456,348,&#xA;3492,3517,3521,3524,3530,3587,383,387,3894,409,472,502,55,5864,5875,5881,5890,6181,625,6386,645,666,741,756,796,871,922,971)&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 14&#xA;and DepartmentKey in (287,3260)&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 9&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 14&#xA;and DepartmentKey in (5819)&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 96&#xA;and DepartmentKey in (4137,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4597)&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 222&#xA;and DepartmentKey in (6954)&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 222&#xA;and DepartmentKey in (6961,7124,7124,7206,7220,7305,7338,7378,7378,7378,7378,7378,7378,7378,7378,7378,7378,7378,7378,7378,7378,7378,7378,7378,7378,7378)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 9&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 175&#xA;and DepartmentKey in (3406)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 177&#xA;and DepartmentKey in (6072)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 169&#xA;and DepartmentKey in (4321,4321,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529,4529)&#xA;and VisitCategoryKey is null&#xA;;&#xA;--set all Unknowns&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 9&#xA;where DepartmentKey in (3406)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 67&#xA;and DepartmentKey in (4059,4116,4116,4128,4128,4164,4164,4164,4164,4164,4164,4164,4164,4164,4164,4164,4164,4164,4164,4164,4164,4164,4164,4164,4164,4164)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 86&#xA;and DepartmentKey in (4274,4396,4396,4396,4396,4396,4396,4396,4739,4739,4739)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 136&#xA;and DepartmentKey in (4059,4059,4059,4059,4059,4059,4059,4059,4059,4059,4059,4060,4060,4062,4062,4062,4062,4062,4062,4062,4062,4062,4062,4062,4062,4062)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 136&#xA;and DepartmentKey in (4107,4107,4291,4291,4291,4291,4291,4291,4291,4291,4291,4291,4291,4291,4291,4291,4291,4291,4291,4291,4291,4291,4291,4291,4291,4291)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 9&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 136&#xA;and DepartmentKey in (5348,5348,5348,5348,5348,5348,5348,5348,5348,5348,5348,5348,5348,5458,5948,5974,5974,5974,5974,5974,5987,5987,5987,5987,5987,5987)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 141&#xA;and DepartmentKey in (154)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 9&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 76&#xA;and DepartmentKey in (5314)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 76&#xA;and DepartmentKey in (4103)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 152&#xA;and DepartmentKey in (4321,4529)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 192&#xA;and DepartmentKey in (6609)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 193&#xA;and DepartmentKey in (6609,6614,6617)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 186&#xA;and DepartmentKey in (6633,6633,6636,6636,6636,6636,6636,6636,6636,6636,6644,6644,6644)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 214&#xA;and DepartmentKey in (6630,6657,6657,6657,6657,6657,6657,6657,6657,6657,6657,6657,6657,6657,6657,6657,6657,6657,6657,6657,6657,6657,6657,6657,6657,6657)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 160&#xA;and DepartmentKey in (4137,4209,4209,4209,4209,4209,4209,4209,4209,4209,4209,4209,4209,4209,4209,4209,4209,4455,4878)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 154&#xA;and DepartmentKey in (4736,5357)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 10&#xA;and DepartmentKey in (4,6)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 10&#xA;and DepartmentKey in (1734,1734,2299,2299,2299,2299,2299,2576,5540,5540,9098,9098,9098)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 9&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 10&#xA;and DepartmentKey in (3978,6603,6603,6603,6603,6603)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 46&#xA;and DepartmentKey in (4144,4144,4144,4237,4246,4246,4246,4246,4246,4246,4246,4246,4246,4246,4246,4246,4246,4246,4246,4246,4246,4246,4246,4246,4246,4246)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 9&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 46&#xA;and DepartmentKey in (4267)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 165&#xA;and DepartmentKey in (4529)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 12&#xA;and DepartmentKey in (1005,1017,1021,1022,1033,1057,106,1063,1067,1069,1072,1092,1107,1110,1141,115,1150,1151,1152,1155,1156,1164,1165,117,1171,1173)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 9&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 12&#xA;and DepartmentKey in (1049,1209,2804,2822,3310,341)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 142&#xA;and DepartmentKey in (3667,3890)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 137&#xA;and DepartmentKey in (5175)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 9&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 137&#xA;and DepartmentKey in (5348)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 188&#xA;and DepartmentKey in (5061,5300)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 111&#xA;and DepartmentKey in (4215,4331,4352,4353,4391,4500,4584,4680,4825,4850,4927,4986,5000,5058,5061,5063,5124,5125,5139,5157,5177,5202,5300,5342,5366,5396)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 2&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 33&#xA;and DepartmentKey in (10,100,1000,1003,1004,1005,1006,1008,1009,101,1011,1012,1014,1016,1017,1019,102,1020,1021,1022,1023,1026,1027,1028,1029,1030,10)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 2&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 36&#xA;and DepartmentKey in (10,1017,1021,1022,1027,1033,1044,1057,106,1062,1067,1069,1084,1098,1107,1110,1118,1120,1129,1136,1143,1150,1151,1152,1155,1165)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 2&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 163&#xA;and DepartmentKey in (10,100,1000,1005,1007,1008,1009,1011,1012,1014,1016,1017,102,1021,1022,1026,1027,1029,1033,1037,1038,1040,1041,1053,1055,1056,1)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 2&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 37&#xA;and DepartmentKey in (10,100,1000,1003,1004,1005,1006,1007,1008,1009,101,1011,1012,1013,1014,1015,1016,1017,1019,102,1020,1021,1022,1023,1026,1027,10)&#xA;and VisitCategoryKey is null&#xA;;&#xA;--------&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 2&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 147&#xA;and DepartmentKey in (4059,4064,4067,4068,4083,4097,4100,4110,4111,4115,4116,4122,4125,4134,4137,4139,4146,4149,4151,4164,4167,4175,4176,4187,4188,4191)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 33&#xA;and DepartmentKey in (1109,1346,1675,174,1842,2299,2527,2801,287,300,3059,3186,3260,3489,4511,4662,4874,4950,6524,6686,698,9179,9305,934)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 36&#xA;and DepartmentKey in (174,9179)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 37&#xA;and DepartmentKey in (1109,1227,1344,1346,1351,1413,1573,1673,1675,1734,174,1752,1842,1843,2045,2234,2299,2309,2394,253,2639,2801,2823,2842,287,290,2)&#xA;and VisitCategoryKey is null&#xA;;&#xA;----&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 9&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 33&#xA;and DepartmentKey in (1039,1052,116,1209,13,1367,137,141,1485,1615,1669,1687,1729,180,2046,2099,2112,2166,2198,2315,2414,2469,2609,2885,294,3099,3304)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 9&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 36&#xA;and DepartmentKey in (1209,1485,1615,1616,1740,180,2103,2166,2469,2575,2804,2885,3300,3310,3406,341,3621,3678,3719,99)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 9&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 163&#xA;and DepartmentKey in (180,3983)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 9&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 37&#xA;and DepartmentKey in (1039,1047,1049,116,1209,1215,1231,1367,137,1396,141,1417,1469,1485,150,1577,1615,1653,1669,1687,1729,180,1817,1893,20,2046,2071)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 3&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 123&#xA;and DepartmentKey in (4062,4064,4170,4240,4310,4350,4498,4506,4537,4566,4857,4877,4911,5133,5259,5343,5465,5952)&#xA;and VisitCategoryKey is null&#xA;;&#xA;-----&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 3&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 38&#xA;and DepartmentKey in (100,1000,1004,1005,1011,102,1023,1027,1029,1032,1033,1043,1055,1057,1066,1070,1074,1082,1084,1092,1095,1107,1112,1114,1116,1120)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 3&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 34&#xA;and DepartmentKey in (1000,1004,1017,1021,1055,1067,1092,1095,1098,1107,1110,1118,1141,1150,1155,1156,117,1171,1173,1175,1187,1193,1198,1201,1205,1210)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 3&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 43&#xA;and DepartmentKey in (10,100,1000,1004,1005,1007,1008,1009,1011,1012,1014,1016,1017,102,1021,1022,1026,1027,1028,1029,1033,1037,1038,1040,1041,1051,1)&#xA;and VisitCategoryKey is null&#xA;;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Set Visit Category Types part 1b"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{A716E1DB-B323-43C9-9A06-E7C438AE68DE}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Set Visit Category Types part 1b"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{C00F5F91-4855-41BC-A28F-D3BCF3559DE6}"
          SQLTask:SqlStatementSource="select distinct([EncounterKey]) as EncounterKey&#xA; into #EncounterKeys&#xA;from [dbo].[FactEncounterEvent_v2]&#xA;where (VisitCategoryKey = 8&#xA;or VisitCategoryKey is null)&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 3&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 217&#xA;and DepartmentKey in (4221,4240,4264,4280,4435,4521,4557,4656,4736,4837,4849)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 3&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 258&#xA;and DepartmentKey in (8908)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 3&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 153&#xA;and DepartmentKey in (4541,6333)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 43&#xA;and DepartmentKey in (253)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;------&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 3&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 58&#xA;and DepartmentKey in (4292,4300,4310,4347,4415,4421,4433,4506,4739,4806,4817,4849,4886,5040,5059,5126,5218,5279,5303,5339,5433,6016)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 9&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 38&#xA;and DepartmentKey in (116,1729,1817,2414,2648,3353,548)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 9&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 34&#xA;and DepartmentKey in (5620)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 9&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 43&#xA;and DepartmentKey in (180,3983,4007,5620)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 108&#xA;and DepartmentKey in (4064,4110,4137,4235,4237,4280,4283,4284,4310,4432,4557,4710,4739,4929,5061,5175,5198,5253,5257,5267,5343,5381,5945,6434,6644,9139)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 269&#xA;and DepartmentKey in (5253)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 45&#xA;and DepartmentKey in (1019,2703,3069,3112,3451,4008,4062,4064,4111,4161,4167,4170,4179,4191,4204,4240,4243,4245,4255,4310,4315,4321,4323,4350,4371,4421)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 231&#xA;and DepartmentKey in (6978,6993,6997,7012,7051,7095,7152,7162,7167,7191,7230,7269,7294,7297,7324,7674,7782,7899,7986,8065,8100,8107,8155,8188,8306,8383)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;----&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 64&#xA;and DepartmentKey in (4064,4506,4739,5381)&#xA;and VisitCategoryKey is null&#xA;;&#xA;---&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 77&#xA;and DepartmentKey in (4081,4154,4208,4235,4280,4292,4299,4390,4410,4527,4584,4590,4602,4654,4738,5090,5135,5253,5401,6337,6423,9486)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 82&#xA;and DepartmentKey in (4274,4396,4739)&#xA;and VisitCategoryKey is null&#xA;;&#xA;----&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 4&#xA;and DepartmentKey in (1011,1021,1022,1033,1062,107,1070,1110,1116,1126,1150,1165,1171,1173,1175,1179,118,1189,1193,1198,1199,121,1210,1224,1225,123,1)&#xA;and VisitCategoryKey is null&#xA;;&#xA;--&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 24&#xA;and DepartmentKey in (1033,107,1070,1092,115,1156,1189,1191,1205,1211,1225,1230,1365,1458,1461,1511,1529,1690,1694,1710,173,1746,1756,1774,1872,1891)&#xA;and VisitCategoryKey is null&#xA;;&#xA;----&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 224&#xA;and DepartmentKey in (7013,7325,7709,7953,8217,8913,8916,9434)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 57&#xA;and DepartmentKey in (4064,4111,4116,4149,4164,4170,4189,4200,4209,4221,4226,4237,4240,4255,4264,4283,4284,4291,4310,4321,4323,4350,4352,4381,4391,4411)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 40&#xA;and DepartmentKey in (1032,1474,1502,169,1918,2303,233,2514,2608,2671,2746,2990,3663,3885,503,898)&#xA;and VisitCategoryKey is null&#xA;;&#xA;----&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 75&#xA;and DepartmentKey in (4059,4064,4137,4164,4191,4235,4237,4240,4272,4280,4310,4321,4323,4350,4352,4374,4414,4435,4500,4506,4521,4526,4616,4655,4656,4696)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 191&#xA;and DepartmentKey in (6609,6612,6613,6614,6617,6621,6628,6630,6632,6634,6636,6643,6646,6650,6652,6654,6655,6763,6766)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 194&#xA;and DepartmentKey in (6613,6614,6615,6621,6630,6631,6632,6633,6634,6636,6643,6644,6646,6650,6652,6655,6658,6763,9482)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 184&#xA;and DepartmentKey in (6615,6631,6633,6636,6644,6658)&#xA;and VisitCategoryKey is null&#xA;;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Set Visit Category Types part 2a"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{672A7B0A-2948-4CE6-935C-B1609F77615B}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Set Visit Category Types part 2a"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{C00F5F91-4855-41BC-A28F-D3BCF3559DE6}"
          SQLTask:SqlStatementSource="select distinct([EncounterKey]) as EncounterKey&#xA; into #EncounterKeys&#xA;from [dbo].[FactEncounterEvent_v2]&#xA;where (VisitCategoryKey = 8&#xA;or VisitCategoryKey is null)&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 204&#xA;and DepartmentKey in (6615,6633,6644,6658)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 208&#xA;and DepartmentKey in (6614,6646)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 55&#xA;and DepartmentKey in (4102,4774,4912,5065,5095)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 178&#xA;and DepartmentKey in (1012,1045,1435,1938,1960,315,3941,4033,598,615,6546,6548,6559,6574,6584,6592,6593,6598,6605,6607,805)&#xA;and VisitCategoryKey is null&#xA;;&#xA;---&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 236&#xA;and DepartmentKey in (7069,7118,8908)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 238&#xA;and DepartmentKey in (6964,7041,7150,8392,8518,8533,8569,8585,8814,8833,8834)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 48&#xA;and DepartmentKey in (4098,4133,4197,4204,4216,4223,4245,4265,4287,4288,4341,4352,4353,4380,4391,4398,4409,4437,4482,4537,4538,4571,4573,4577,4596,4623)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 5&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 256&#xA;and DepartmentKey in (6951,6987,6991,6993,6998,7007,7012,7022,7024,7041,7044,7051,7052,7057,7088,7095,7099,7105,7119,7123,7165,7167,7169,7170,7186,7191)&#xA;and VisitCategoryKey is null&#xA;;&#xA;-----&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 5&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 257&#xA;and DepartmentKey in (8908,9119)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 6&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 139&#xA;and DepartmentKey in (1922,4521)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 6&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 264&#xA;and DepartmentKey in (1493)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 6&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 218&#xA;and DepartmentKey in (6905)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 9&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 88&#xA;and DepartmentKey in (3406)&#xA;and VisitCategoryKey is null&#xA;;&#xA;---------------&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 6&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 8&#xA;and DepartmentKey in (6169,6905)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 6&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 266&#xA;and DepartmentKey in (472)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 6&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 9&#xA;and DepartmentKey in (101,1192,1294,1332,1410,162,1691,1876,1947,1993,2088,2260,2322,2380,2389,2404,2512,2605,2719,2724,2877,2986,3111,3146,3165,3266)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 6&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 270&#xA;and DepartmentKey in (6658,9479)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;--------------&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 6&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 162&#xA;and DepartmentKey in (1928,6169,6905)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 28&#xA;and DepartmentKey in (100,1013,1017,1021,1033,1035,1037,106,1065,1067,1074,1092,1108,1110,1116,1126,1134,1136,1141,1145,1150,1154,1155,1160,1164,1171)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 72&#xA;and DepartmentKey in (4274,4396,4739)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 164&#xA;and DepartmentKey in (4064,4975,4979,5054,5124,5125,5139,5157,5175,5185,5202,5342,5445,6413)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 18&#xA;and DepartmentKey in (1000,2658)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 32&#xA;and DepartmentKey in (113,1140,1349,1350,1515,1623,1850,2511,2731,3297,34,380,4060,4077,4155,4158,4168,4189,4190,4222,4245,4258,4260,4274,4304,4331,4)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 78&#xA;and DepartmentKey in (4081,4111,4137,4151,4154,4187,4208,4221,4235,4237,4243,4280,4284,4292,4299,4323,4390,4399,4410,4506,4527,4546,4584,4590,4602,4616)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 71&#xA;and DepartmentKey in (4110,4529,4655,4739)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 50&#xA;and DepartmentKey in (4447,4878,6343)&#xA;and VisitCategoryKey is null&#xA;;&#xA;&#xA;--------&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 49 and DepartmentKey in (4447,6343)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 248 and DepartmentKey in (8908)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 168 and DepartmentKey in (4396,4739)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 51 and DepartmentKey in (4274,4396,4739)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 85 and DepartmentKey in (4739)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 54 and DepartmentKey in (4125,4244,4249,4274,4396,4663,4739)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 22 and DepartmentKey in (1005,1026,1089,1113,1146,1179,1220,1263,1287,1354,1394,1400,1401,1412,1430,1540,1565,1576,1594,16,1636,1650,1685,1700,1709,1713)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 23 and DepartmentKey in (1014,1029,1033,1051,1056,1062,1066,1067,1073,1086,1091,1105,1110,1113,1118,1141,1146,1149,1150,1151,1152,1171,1173,118,1185,1188)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 21 and DepartmentKey in (1017,1033,1084,1087,1136,1252,1262,1291,1366,1369,1410,145,1529,1710,172,1723,1916,1929,1943,2005,2117,2228,2258,2312,24,2511,2)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 41 and DepartmentKey in (861)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 27 and DepartmentKey in (1015,1020,1031,1032,1036,1043,1044,1046,1058,1061,1076,1077,1082,1092,1097,1103,1106,111,1111,1112,1115,1125,113,1132,1139,1147)&#xA;and VisitCategoryKey is null&#xA;;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Set Visit Category Types part 2b"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{45C8397E-7E73-45B1-B269-399F20B9D13E}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Set Visit Category Types part 2b"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{C00F5F91-4855-41BC-A28F-D3BCF3559DE6}"
          SQLTask:SqlStatementSource="select distinct([EncounterKey]) as EncounterKey&#xA; into #EncounterKeys&#xA;from [dbo].[FactEncounterEvent_v2]&#xA;where (VisitCategoryKey = 8&#xA;or VisitCategoryKey is null)&#xA;;&#xA;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  68 and DepartmentKey in (4739)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  39 and DepartmentKey in (1057,1262,1386,1404,1696,1716,1790,1862,1997,2617,266,2713,2774,2897,291,3409,3529,5865,741,753,809,9239)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  158 and DepartmentKey in (4399,6337,6632,6650,6763,6773)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  215 and DepartmentKey in (6630,6632)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  159 and DepartmentKey in (4399,6337,6773)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  1 and DepartmentKey in (1021,1033,1041,1070,1189,1191,1193,1206,1230,1253,127,1272,1306,1329,1334,1442,1445,1550,1561,1608,163,1728,1793,1813,1844,1860)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  6 and DepartmentKey in (1005,1091,118,122,1233,1362,1424,1490,1494,1532,1550,1587,1619,1645,1691,1723,1755,1876,1881,1940,2016,2081,2195,2370,2393,2407)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  44 and DepartmentKey in (6063,6089,6229)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  62 and DepartmentKey in (4739)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  30 and DepartmentKey in (7024,7052,7205,7317,7650,7694,7829,8462,8468,8785,8878,8880,9093)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  84 and DepartmentKey in (4739)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  60 and DepartmentKey in (4447,6343)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  59 and DepartmentKey in (4447,6343)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  271 and DepartmentKey in (6343)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  73 and DepartmentKey in (4064,4110,4111,4137,4151,4161,4167,4187,4191,4221,4237,4240,4243,4244,4255,4264,4280,4283,4310,4321,4323,4329,4404,4414,4426,4432)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  267 and DepartmentKey in (6343)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  11 and DepartmentKey in (1000,1005,1009,1011,1012,1017,102,1021,1022,1033,1035,1036,1037,106,1062,1067,107,1070,1084,1086,1087,1088,11,1110,1114,1116,11)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  66 and DepartmentKey in (4064,4103,4110,4111,4115,4137,4161,4187,4204,4230,4237,4240,4244,4255,4283,4310,4321,4323,4336,4426,4432,4435,4500,4506,4551,4557)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  13 and DepartmentKey in (10,1009,106,1099,1116,1171,1175,118,1181,1188,1196,1224,1234,1240,1254,1262,1304,131,1373,1376,1410,144,1471,1505,1512,1517,152)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  130 and DepartmentKey in (4079,4117,4302,4321,4656,4683,4749,4817,6322,6426,6780,6791,6802,6822,9137,9489,9644)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  3 and DepartmentKey in (10,100,1000,1003,1005,1006,1007,1008,1009,101,1011,1012,1014,1016,1017,102,1021,1022,1026,1028,1029,1033,1035,1036,1037,1038,10)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  239 and DepartmentKey in (6954,6959,6965,6972,6978,6980,6985,6987,6991,7000,7012,7017,7019,7032,7044,7045,7049,7051,7052,7064,7069,7070,7084,7094,7095,7096)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  2 and DepartmentKey in (1005,1016,102,1029,1054,1056,107,1081,1095,1102,1104,1108,1116,1130,1133,1135,1136,1137,1141,1145,1149,115,1152,1159,1163,1171)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  79 and DepartmentKey in (4064,4110,4111,4115,4116,4137,4144,4146,4187,4204,4215,4229,4230,4235,4237,4240,4243,4249,4264,4273,4280,4283,4284,4289,4292,4293)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  25 and DepartmentKey in (1000,1005,1008,1012,1017,1027,1029,1037,1065,1074,1084,1092,1095,11,1137,1141,1145,1152,1153,1175,1182,1194,1199,1212,1222,1234)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  105 and DepartmentKey in (4125,4249,4274,4396,4739,4825,4910)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  29 and DepartmentKey in (1174,2623,3478,70)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  69 and DepartmentKey in (4064,4312,4433,4500,4501,4510,4609,5048,5073,5173)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  20 and DepartmentKey in (2482,3115,3522,972)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  268 and DepartmentKey in (6613,6652)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  53 and DepartmentKey in (4358,4390,4491,4695,4712,4821,4975,5088,5107,5308,6330,6417,6423,6639)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  52 and DepartmentKey in (4358,4390,4491,4695,4712,4821,4975,5088,5107,5308,5453,6330,6417,6423,6639)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  189 and DepartmentKey in (6609,6613,6614,6617,6621,6628,6629,6630,6631,6632,6634,6638,6643,6645,6646,6650,6652,6654,6655,6763,6770)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  181 and DepartmentKey in (4479,5008,5089,6609,6612,6613,6614,6615,6616,6617,6621,6623,6627,6628,6629,6630,6631,6632,6633,6634,6636,6637,6638,6641,6643,6644)&#xA;and VisitCategoryKey is null&#xA;;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  181 and DepartmentKey in (4479,5008,5089,6609,6612,6613,6614,6615,6616,6617,6621,6623,6627,6628,6629,6630,6631,6632,6633,6634,6636,6637,6638,6641,6643,6644)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  157 and DepartmentKey in (4187,4289,4399,4658,4909,4927,5089,6337,6773)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  156 and DepartmentKey in (4399,4433,4656,6337,6413,6773)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  263 and DepartmentKey in (4739)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  129 and DepartmentKey in (4105,4145,4219,4295,4319,4359,4392,4544,4554,4583,4682,4705,4792,4830,4913,5169,6767,6777,6779,6782,6786,6790,6792,6794,6797,6800)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  7 and DepartmentKey in (1005,1091,1119,1199,1233,1362,1424,1490,1494,1532,1587,1619,1629,1645,1691,1755,1876,1881,1940,2007,2016,2081,2099,2195,2265,2393)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  70 and DepartmentKey in (4060,4249,4396,4415,4548,4739)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  212 and DepartmentKey in (6609,6613,6614,6617,6628,6643,6650)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  195 and DepartmentKey in (6609,6614,6617,6621,6628,6634,6643,6650,6655,6657)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  196 and DepartmentKey in (6617,6621,6650,6652)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  197 and DepartmentKey in (6613,6621,6630,6632,6634,6646,6650,6652,6654,6763)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  198 and DepartmentKey in (6621,6630,6646,6650,6652,6763)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  211 and DepartmentKey in (6609,6612,6614,6617,6621,6628,6632,6634,6643,6648,6650,6654,6655,6657,6763,6766)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  272 and DepartmentKey in (6658,9474,9479,9481,9490)&#xA;and VisitCategoryKey is null&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  199 and DepartmentKey in (6614,6627,6630,6632,6646,6652,6654,6655,6763,9482)&#xA;and VisitCategoryKey is null&#xA;;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Set Visit Category Types part 3a"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{E584A112-FE9A-4D21-87FB-40AC0748094D}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Set Visit Category Types part 3a"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{C00F5F91-4855-41BC-A28F-D3BCF3559DE6}"
          SQLTask:SqlStatementSource="select distinct([EncounterKey]) as EncounterKey&#xA; into #EncounterKeys&#xA;from [dbo].[FactEncounterEvent_v2]&#xA;where (VisitCategoryKey = 8&#xA;or VisitCategoryKey is null)&#xA;;&#xA;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  202 and DepartmentKey in (6609,6613,6621,6630,6631,6632,6633,6634,6643,6644,6646,6650,6652,6654,6655,6657,6658,6763,9482)&#xA;&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  183 and DepartmentKey in (6609,6613,6614,6621,6627,6630,6631,6632,6633,6636,6643,6646,6650,6652,6654,6655,6658,6763,9482)&#xA;&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  203 and DepartmentKey in (6613,6614,6621,6627,6630,6631,6632,6633,6634,6636,6643,6646,6650,6652,6655,6657,6658,6763,9482)&#xA;&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  210 and DepartmentKey in (6631,6763)&#xA;&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  213 and DepartmentKey in (6615,6631,6633,6636,6644,6658)&#xA;&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  205 and DepartmentKey in (6613,6630,6631,6632,6633,6644,6657,6658)&#xA;&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  206 and DepartmentKey in (6615,6621,6630,6631,6632,6633,6636,6644,6646,6655,6657,6658,6763)&#xA;&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  185 and DepartmentKey in (6609,6613,6615,6621,6630,6631,6632,6633,6636,6643,6644,6646,6652,6655,6657,6658,6763)&#xA;&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  209 and DepartmentKey in (6631)&#xA;&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  207 and DepartmentKey in (6615,6630,6631,6633,6644,6646,6657,6658)&#xA;&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  234 and DepartmentKey in (6954,7017,7051,7064,7107,7154,7163,7167,7204,7219,7296,7420,7512,7515,7525,7661,7747,7755,7771,7801,7864,8112,8129,8252,8486,8493)&#xA;&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  233 and DepartmentKey in (6954,6975,7017,7039,7051,7064,7107,7154,7163,7167,7204,7219,7296,7330,7420,7512,7515,7525,7661,7747,7755,7801,7864,7871,8112,8129)&#xA;&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey =  26 and DepartmentKey in (100,1033,1084,1092,1141,1156,1171,1177,1212,125,1264,1295,1312,1333,1334,1355,139,1415,1416,1468,1486,1493,1509,1519,1525,1537)&#xA;&#xA;;&#xA;&#xA;----&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 27 and DepartmentKey in (1,1001,1002,1004,1010,1018,1023,1024,1025,103,1034,1042,105,1060,1078,1083,1085,109,1094,1096,110,1109,112,1122,1127,1138,1158)&#xA;&#xA;;&#xA;&#xA;&#xA;-------------&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 27 &#xA;and DepartmentKey in (2034,287,771,300,4531,944,3489,3342,1843,1675,3260,4774,174,2921,851,47&#xA;,1465,2955,4291,5102,4503,5281,4207,3400,4874,4400,239,5092,518,4107,1784,2931,4065,842&#xA;,6524,4611,2394,9305,920,401,549,4343,4790,3547,403&#xA;,3059,5518,4603,9343,5933,1346,2234,5438,4771,2715,2003,1413,1510,3488,4385,2823,2639,4407,234&#xA;,1482,215,706,593,1573,1973,9179,290&#xA;,1761,4214,1227,3268,9152,4333,1753,2037,4674,6501,4764,2554,934&#xA;,4476,4016,4270,1244,3267,968,664,2045,3514,368&#xA;,4425,1842,3362,494&#xA;,6896,2349,4459,3927,3464,2153,1344,4799,1834,6196,1882,3546,4368,75&#xA;,1491,698,974,930,1777,5010,6182,2620,4330,4950,4604,1351,1169,217&#xA;,4824,2527,4108,9279,2919,296,4072,3186,2842,9273,4511,3040,4422,2336,4397,6892,3834,3544,4379,5035,1315,3744,6176,957,948&#xA;,2375,6835,1488,6445,4124,5636,6902,6213,4995,5535,3375,628,6827,6263,5160,6776,5479,6832,5481,5615,6217,6332,3473,6108,9254,590&#xA;,5803,9274,9312,6254,5541,3807,5720,5685,4453,3616,5564,2948,4767,3194,5501,5617,9507,2922,6107,4441,9543,4182,513&#xA;,5128,2602,2576,5483,4198,5537,4290,5792,465&#xA;,4420,1734,5623,6824,2299,4129,5233,4206,935&#xA;,5844,9519,1528,4180,3773,9625,1894,3352,2182,3569,6206,3788,787&#xA;,3588,3720,5862,2052,6212,3845,1673,3655,3611,5765,522,129,42&#xA;,2801,5161,4120,3943,241,6320,6900,6681,5866,5164,6449,6862,6735,6740,9599,333,6596,5935,9610,6723)&#xA;&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 27 &#xA;and DepartmentKey in (4478,4372,4777,4484,4918,5302,5356,4486,6002,4275,4075&#xA;)&#xA;&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 27 &#xA;and DepartmentKey in (998,9022,7234,6618,9128,7907,8862,8328,7725,7459,7390,8077,9556,7942,7588,7166,7185,569,2598,2049,2264,1284,3150,1654,3420,1782,177,492,2125,3531,449,1291,3440,1566,3385,1871,3411,3397,3153,2682,2635,298,3634,2319&#xA;,3506,1634,2697,487,2060,1496,3615,3402,3996,1216,2372,657,936,2255,1800,1600,3801,2859,6477,419,6402,6350,1251,2846,371,6300,6278,1575,6316,1705,6314,6499,6698,6715,3081,6074,6035,3775,6312,800,6083&#xA;,1168,6165,1148,3152,1611,6480,1218,250,3159,6105,2352,198,2306,1383,334,2391,5810,6032,9356,5549,6306,3321,1243&#xA;)&#xA;&#xA;;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 27 &#xA;and DepartmentKey in (7416,7746,7974,8971,7454,8571,8735,7593,8647,7611,7089,8639,7021,8563,8910,8935,8879,8787,8068,9053,8891,8260,8267,7072,8466,8696,9443,8768)&#xA;&#xA;;&#xA;&#xA;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 27 &#xA;and DepartmentKey in (4773,7590,8492,4363,8226,8044,8249,7721,7159,4451,8618,4093,4721,5072,4094,4184,5962,6624)&#xA;&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 27 &#xA;and DepartmentKey in (8966,8186)&#xA;&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 27 &#xA;and DepartmentKey in (8428,8376,9011,7065,7082,9078,7350,7930,8961,7645,7469,8209,8711,8141,8817,7417,9035,8936,7287,8205,8778,8295,8795,8483)&#xA;&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 27 &#xA;and DepartmentKey in (733,209,8111,4442,8497,8337,8278,7549,8811,7643,7693,8590,4751,4210,7798,4301,8523,&#xA;4485,5467,7929,9065,4259,8281,8950,4436,5228,5030,4897,5926,7624,8447,7522,8053,5012,8109,7126,8745,4922,7098,8586,8986)&#xA;&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 27 &#xA;and DepartmentKey in (3560,2629,222,3215,1384,2674,3785)&#xA;&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 27 &#xA;and DepartmentKey in (1508,1749,1436,1504,3132,931,1870,1637,784,2241,558,2451,2632,665,1655,1853,2591,3374&#xA;,2369,1754,1406,3014,2571,816,3484,2179,3431,357,4522,2188,2858,3334,2211,1630,244,989,2137,2899,2008,515,2463,1801,4829,2173,1849,4090,66,1816,745,1671,310,2162,3195,818&#xA;,2221,1651,1279,612,4576,1931,710,4357,1484,1811,3827,2361,2254,1750,2905,2097,2073,2115,3258,3316,5183,2200,2954,1981,1714,1223,5076,1389,712,4212,3920,2187,1524,2089,4540,507,2143,2880,2367,3068,2351,1722,2436&#xA;,990,4169,3759,3113,496,3371,2328,1739,422,1260,2094,2302,1605,3781,1455,2666,2208,4332,1885,755,5120,3019,673,354,4309,2377,1381,906,783,6239,2124,3299,2013,2485,2362,3237&#xA;,1621,1945,1925,3320,4326,1546,2841,559,399,2297,3636,2146,576,1298,4781,2355,4013,3982,8277,3023,3303,3935,2126,2320,390,5911,1341,534,5379,4101,722,3057,3574,1422,4612,2946,2194&#xA;,1963,3629,251,3641,2857,2647,3764,852,2749,3388,1370,2024,2867,248,8282,976,311,8829,1545,7686,7270,5589,1890,3311,742,8642,4621,6533,1854,3527,2521,3396,8407,3600,2300,3211,3047&#xA;,2558,3394,1806,8475,693,304,1688,2214,1305,5869,2479,686,687,694,4071,2429,3029,1447,3866,2831,1382,7424,176,2435,6542,2348,463,695,2812,1676,2015,4047,6849,3934,2116,4091,3467,3804,2333,631,5635,5868&#xA;,3206,4039,858,9417,1980,1602,2096,3283,655,6502,5843,1670,8912,573,2564,4370,4040,8458,5788,4046,418,1448,3640,5723,3,6503,442,5591,8840,2452,8909,6971,6679,1213,5022,6110,1571&#xA;,3793,9249,566,3593,6671,8796,3849,571,5856,4253,1639,9323,2908,1441,1769,15,205,5756,435,1221,3683,1533,719,5798,1643,9358,627,3063,9221,2649,3221,689,3505,2561,2138&#xA;,136,8182,9295,2750,3932,2271,1311,7802,4387,3705,8351,9167,2378,1995,9330,3956,3803,9613,2169,897,5793,2368,9079,5580,9306,312,2227,5545,2726,3292,2450,8485,7467,9171&#xA;,827,7408,9353,764,3157,9066,2760,4052,9233,3976,3381,382,6447,9216,752,3964,6875,516,3643,3706,6841,8203,788,3509,6894,9336,9525,2747,6826,6871,7556,9204,6868,2502,3717&#xA;,1536,6874,2493,5614,2683,3926,6853,3423,1682,3204,9528,9638,2202,3815,3813,963,3349,3168,2694,9399,351,2253,1427,2803,2176,9554,6174,5897,1336,7906,7509,3196&#xA;,6390,1962,4698,8253,512,5346,1770,2863,3933,332,6569,9465,402,9511,6458,2030,1724,5839,5223,9475,9628,221,6919,9388,9623,3443,5845,5508,6921,2252,9590,6674)&#xA;&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys) and EncounterTypeKey = 27&#xA;&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;from [dbo].[FactEncounterEvent_v2] fact&#xA; join dbo.DimEncounterType et&#xA;  on fact.EncounterTypeKey = et.EncounterTypeKey&#xA; join dbo.DimDepartment ds&#xA;  on fact.DepartmentKey = ds.DepartmentKey&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys)&#xA;  --and et.EncounterTypeName = 'Hospital Encounter'&#xA;  --and et.EncounterTypeName = 'After Hours Office Visit'&#xA;  --and et.EncounterTypeName = 'Office Visit'&#xA;  and et.EncounterTypeName = 'CC Office Visit'&#xA;  and ds.DepartmentSpecialty in ('Cardiology','Family Medicine','Gastroenterology','General Internal Medicine','General Surgery','Gynecologic Oncology','Hematology and Oncology','Internal Medicine','Nephrology','Neurology','Obstetrics and Gynecology','Orthopedic Surgery','Pain Medicine','Pediatric Neurology','Pediatric Pulmonology',&#xA;  'Pediatrics','Psychiatry','Sports Medicine','Thoracic Diseases','Urgent Care','Urology','Walk In')&#xA;&#xA;;&#xA;-----&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;from [dbo].[FactEncounterEvent_v2] fact&#xA; join dbo.DimEncounterType et&#xA;  on fact.EncounterTypeKey = et.EncounterTypeKey&#xA; join dbo.DimDepartment ds&#xA;  on fact.DepartmentKey = ds.DepartmentKey&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys)&#xA;  and et.EncounterTypeName = 'CTO'&#xA;  and ds.DepartmentSpecialty in ('Cardiology')&#xA;&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;from [dbo].[FactEncounterEvent_v2] fact&#xA; join dbo.DimEncounterType et&#xA;  on fact.EncounterTypeKey = et.EncounterTypeKey&#xA; join dbo.DimDepartment ds&#xA;  on fact.DepartmentKey = ds.DepartmentKey&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys)&#xA;  and et.EncounterTypeName = 'AC Pharmacy Question'&#xA;  and ds.DepartmentSpecialty in ('Internal Medicine','Pediatrics')&#xA;&#xA;;&#xA;---&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;from [dbo].[FactEncounterEvent_v2] fact&#xA; join dbo.DimEncounterType et&#xA;  on fact.EncounterTypeKey = et.EncounterTypeKey&#xA; join dbo.DimDepartment ds&#xA;  on fact.DepartmentKey = ds.DepartmentKey&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys)&#xA;  and et.EncounterTypeName = 'AC Results'&#xA;  and ds.DepartmentSpecialty in ('Cardiac Intensive Care','Family Medicine','Gastroenterology','Hospital Medicine','Internal Medicine and Pediatrics','Obstetrics and Gynecology','Walk In')&#xA;&#xA;;&#xA;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;from [dbo].[FactEncounterEvent_v2] fact&#xA; join dbo.DimEncounterType et&#xA;  on fact.EncounterTypeKey = et.EncounterTypeKey&#xA; join dbo.DimDepartment ds&#xA;  on fact.DepartmentKey = ds.DepartmentKey&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys)&#xA;  and et.EncounterTypeName = 'Advance Care Planning (ACP)'&#xA;  and ds.DepartmentSpecialty in ('Administration','Cardiology','Dermatology','Family Medicine','Gastroenterology','Home Health Services','Hospice and Palliative Medicine','Hospice Services',&#xA;'Integrative Medicine','Internal Medicine','Internal Medicine and Pediatrics','Nursing','Occupational Medicine','Oncology','Pastoral Care','Pediatrics',&#xA;'Population Health','Psychiatry','Social Services','Urgent Care','Urology')&#xA;&#xA;;&#xA;-----&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;from [dbo].[FactEncounterEvent_v2] fact&#xA; join dbo.DimEncounterType et&#xA;  on fact.EncounterTypeKey = et.EncounterTypeKey&#xA; join dbo.DimDepartment ds&#xA;  on fact.DepartmentKey = ds.DepartmentKey&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys)&#xA;  and et.EncounterTypeName = 'CAHPS Survey Testing'&#xA;  and ds.DepartmentSpecialty in ('Dentistry','Endocrinology','Gerontology','Infectious Diseases','Neurology','Orthopaedic Surgery','Pain Medicine','Plastic Surgery')&#xA;&#xA;;&#xA;&#xA;&#xA;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
    <DTS:Executable
      DTS:refId="Package\Set Visit Category Types part 3b"
      DTS:CreationName="Microsoft.ExecuteSQLTask"
      DTS:Description="Execute SQL Task"
      DTS:DTSID="{29813079-ADEF-4CC9-9D29-103E97B98CD3}"
      DTS:ExecutableType="Microsoft.ExecuteSQLTask"
      DTS:LocaleID="-1"
      DTS:ObjectName="Set Visit Category Types part 3b"
      DTS:ThreadHint="0">
      <DTS:Variables />
      <DTS:ObjectData>
        <SQLTask:SqlTaskData
          SQLTask:Connection="{C00F5F91-4855-41BC-A28F-D3BCF3559DE6}"
          SQLTask:SqlStatementSource="select distinct([EncounterKey]) as EncounterKey&#xA; into #EncounterKeys&#xA;from [dbo].[FactEncounterEvent_v2]&#xA;where (VisitCategoryKey = 8&#xA;or VisitCategoryKey is null)&#xA;;&#xA;&#xA;&#xA;------------------&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;from [dbo].[FactEncounterEvent_v2] fact&#xA; join dbo.DimEncounterType et&#xA;  on fact.EncounterTypeKey = et.EncounterTypeKey&#xA; join dbo.DimDepartment ds&#xA;  on fact.DepartmentKey = ds.DepartmentKey&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys)&#xA;  and et.EncounterTypeName = 'Office Visit'&#xA;  and ds.DepartmentSpecialty in ('Addiction Medicine','Administrative','Adolescent Medicine','Adult Medicine','Allergy','Allergy &amp; Immunology','Allergy and Immunology','Alternative Medicine','Anesthesiology Pain Mgt',&#xA;'Anticoagulation','Audiology','Bariatrics','Behavioral Health','Bone Marrow Transplant','Breast Oncology','Breast Surgery','BURN CARE','Burn Surgery','Cardiac Rehabilitation','Cardiac Surgery',&#xA;'Cardiology','Cardiothoracic Surgery','Cardiovascular Medicine','Care Management','Cast Clinic','Chemotherapy','Child and Adolescent Psychiatry','Child Protection Team',&#xA;'Clinical Pathology/Laboratory Medicine','Clinical Trials Unit','Colon &amp; Rectal Surgery','Colon and Rectal Surgery','Complementary Therapy','Cornea Ophthalmology','Cutaneous Oncology','Dentistry',&#xA;'Dermatology','Dermatology Laser and Cosmetic','Developmental and Behavioral Pediatrics','Diabetes and Nutrition','Diabetes Services','DME Services','Electrophysiology','Emergency Medicine',&#xA;'Endocrinology','Endocrinology, Diabetes &amp; Metabolism','Endoscopy','ENT','Exercise Therapy','Facial Plastics','Family Medicine','Family Medicine/Peds',&#xA;'Family Practice/Internal Medicine and Pediatrics','Flu Clinic','Gastroenterology','Gastrointestinal Oncology','General Internal Medicine','General Medicine','General Surgery','Genetics',&#xA;'Genitourinary Oncology','Geriatric Psychiatry','Gerontology','Glaucoma Ophthalmology','Gynecologic Oncology','Gynecologic Surgery','Gynecological Oncology','Gynecology','Hand Surgery','Hand Therapy',&#xA;'Head and Neck Oncology','Head and Neck Surgery','Hematology','Hematology &amp; Oncology','Hematology and Oncology','Hematology Oncology','Hospice and Palliative Medicine','Hospital Medicine',&#xA;'Infectious Disease','Infectious Diseases','Infusion Therapy','Inpatient','Integrative Medicine','Internal Medicine','Internal Medicine and Pediatrics','Interpreter Services',&#xA;'Interventional Radiology','Leukemia','Lipid','Lymphoma','Mammography','Maternal and Fetal Medicine','Maternal Fetal Medicine','Maxillofacial Prosthodontics','Medical Oncology','Medical Walk In',&#xA;'Melanoma Oncology','Multiple Sclerosis','Multispecialty','Myeloma','Neonatology','Nephrology','Neuro Oncology','Neurointervention','Neurologic Surgery','Neurology','Neuro-Ophthalmology',&#xA;'Neuropsychology','Neurosurgery','Neurosurgery Neuro Oncology','Nutrition','OB/GYN','Obstetrics','Obstetrics and Gynecology','Occupational Medicine','Occupational Therapy','Oculoplastics Ophthalmology',&#xA;'Oncology','Ophthalmology','Ophthalmology Imaging','Optometry','Oral and Maxillofacial Surgery','Oral Medicine and Oncology','Orthopaedic Surgery','Orthopaedics','Orthopedic Surgery','Orthopedics',&#xA;'Orthotics Prosthetics','Otolaryngology','Otology','Otoneurology','Pain Clinic','Pain Medicine','Palliative Care','Palliative Medicine','Pathology','Pediatric Allergy','Pediatric Anesthesia',&#xA;'Pediatric Cardiology','Pediatric Coordinated Care','Pediatric Critical Care Medicine','Pediatric Dermatology','Pediatric Endocrinology','Pediatric Food Allergy','Pediatric Gastroenterology',&#xA;'Pediatric Genetics','Pediatric Hematology and Oncology','Pediatric Hospice and Palliative Medicine','Pediatric Infectious Disease','Pediatric Infusion Therapy','Pediatric Nephrology',&#xA;'Pediatric Neuro Oncology','Pediatric Neurology','Pediatric Neurosurgery','Pediatric Nutrition','Pediatric Occupational Therapy','Pediatric Oncology','Pediatric Orthopedics','Pediatric Otolaryngology',&#xA;'Pediatric Physical Medicine and Rehabilitation','Pediatric Psychiatry','Pediatric Pulmonology','Pediatric Radiation Oncology','Pediatric Rheumatology','Pediatric Speech Therapy','Pediatric Surgery',&#xA;'Pediatric Survivorship Program','Pediatric Urology','Pediatrics','Perinatology','Pharmacy','Physiatry','Physical Medicine &amp; Rehabilitation','Physical Medicine and Rehabilitation','Physical Therapy',&#xA;'Plastic Surgery','Podiatry','Pre-Admission Evaluation','Pre-Admission Testing','Primary Care','Psychiatry','Psychologist/Rehabilitation','Psychology','Psychosocial Oncology','Pulmonary Disease',&#xA;'Pulmonary Rehabilitation','Pulmonology','Pulmonology and Allergy','Radiation Oncology','Reproductive Endocrinology and Infertility','Research','Retina Ophthalmology','Retinal Degeneration Ophthalmology',&#xA;'Retinopathy','Rheumatology','Sarcoma and Bone Oncology','Senior Health','Sinus','Sleep Medicine','Social Services','Speech Therapy','Spine Surgery','Sports Medicine','Stroke','Surgical Oncology',&#xA;'Surgical Ophthalmology','Survivorship Program','Telehealth Primary Care','Thoracic Diseases','Thoracic Oncology','Thoracic Surgery','Tobacco Treatment','Transplant','Transplant Hepatology',&#xA;'Transplant Surgery','Trauma Ophthalmology','Trauma Surgery','Travel Medicine','Ultrasound','Urgent Care','Urogynecology','Urology','Uveitis and Ocular Immunology','Vascular','Vascular Surgery',&#xA;'Vestibular','Virtual Department','Vision Rehab','Walk In','Weight Center','Wellness','Wellness and Prevention','Wound Care')&#xA;&#xA;;&#xA;&#xA;-----------------&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;from [dbo].[FactEncounterEvent_v2] fact&#xA; join dbo.DimEncounterType et&#xA;  on fact.EncounterTypeKey = et.EncounterTypeKey&#xA; join dbo.DimDepartment ds&#xA;  on fact.DepartmentKey = ds.DepartmentKey&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys)&#xA;  --and et.EncounterTypeName = 'Office Visit'&#xA;  and ds.DepartmentSpecialty in ('Lab','Radiology','Imaging VAN','Nuclear Medicine')&#xA;&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 9&#xA;from [dbo].[FactEncounterEvent_v2] fact&#xA; join dbo.DimEncounterType et&#xA;  on fact.EncounterTypeKey = et.EncounterTypeKey&#xA; join dbo.DimDepartment ds&#xA;  on fact.DepartmentKey = ds.DepartmentKey&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys)&#xA;  --and et.EncounterTypeName = 'Office Visit'&#xA;  and ds.DepartmentSpecialty in ('Unknown')&#xA;&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 2&#xA;from [dbo].[FactEncounterEvent_v2] fact&#xA; join dbo.DimEncounterType et&#xA;  on fact.EncounterTypeKey = et.EncounterTypeKey&#xA; join dbo.DimDepartment ds&#xA;  on fact.DepartmentKey = ds.DepartmentKey&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys)&#xA;  and et.EncounterTypeName = 'Telephone'&#xA;  and ds.DepartmentSpecialty in ('Addiction Medicine','Administrative','Adolescent Medicine','Adult Medicine','Allergy','Allergy &amp; Immunology','Allergy and Immunology','Alternative Medicine','Anesthesiology',&#xA;'Anesthesiology Pain Mgt','Anticoagulation','Apheresis','Audiology','Bariatrics','Behavioral Health','Bone Densitometry','Bone Marrow Transplant','Breast Oncology','Breast Surgery',&#xA;'BURN CARE','Burn Surgery','Cardiac Catherization','Cardiac Intensive Care','Cardiac Rehabilitation','Cardiac Surgery','Cardiology','Cardiothoracic Surgery','Cardiovascular Medicine',&#xA;'Care Management','Case Management','Cast Clinic','Central Scheduling','Chemotherapy','Child and Adolescent Psychiatry','Child Life','Child Protection Team','Clinical Trials Unit',&#xA;'Colon &amp; Rectal Surgery','Colon and Rectal Surgery','Complementary Therapy','Computerized Tomography Scan','Coordinated Care','Cornea Ophthalmology','Critical Care','Critical Care Medicine',&#xA;'Cutaneous Oncology','Dentistry','Dermatology','Dermatology Laser and Cosmetic','Developmental and Behavioral Pediatrics','Diabetes and Nutrition','Diabetes Services','Diagnostic Radiology',&#xA;'Durable Medical Equipment Supply/Boutique','Echocardiography','Electrophysiology','Emergency Medicine','Employee Health','Endocrinology','Endocrinology, Diabetes &amp; Metabolism','Endoscopy',&#xA;'Epidemiology','Epilepsy','Facial Plastics','Family Medicine','Family Medicine/Peds','Financial Counseling','Flu Clinic','Fluoroscopy','Gastroenterology','Gastrointestinal Oncology',&#xA;'General Internal Medicine','General Medicine','General Surgery','Genetics','Genitourinary Oncology','Geriatric Psychiatry','Gerontology','Glaucoma Ophthalmology','Gynecologic Oncology',&#xA;'Gynecologic Surgery','Gynecological Oncology','Gynecology','Hand Surgery','Hand Therapy','Head and Neck Oncology','Head and Neck Surgery','Hematology','Hematology &amp; Oncology','Hematology Oncology',&#xA;'Home Health Services','Hospice and Palliative Medicine','Hospitalist','Hyperbaric Medicine','Imaging','Imaging VAN','Infectious Disease','Infectious Diseases','Infusion Therapy','Inpatient',&#xA;'Inpatient Psych','Integrative Medicine','Intensive Care','Internal Medicine','Interpreter Services','Interventional Nephrology','Interventional Radiology','Laryngeal Surgery','Leukemia','Lipid',&#xA;'Lymphoma','Magnetic Resonance Imaging','Mammography','Maternal and Fetal Medicine','Maternal Fetal Medicine','Maxillofacial Prosthodontics','Medical Oncology','Medical Records','Medical Walk In',&#xA;'Melanoma Oncology','Multiple Sclerosis','Multispecialty','Myeloma','Neonatology','Nephrology','Neuro Oncology','Neurologic Surgery','Neurological Intensive Care','Neurology',&#xA;'Neuro-Ophthalmology','Neurophysiology','Neuropsychology','Neurosurgery','Neurosurgery Neuro Oncology','Nuclear Medicine','Nursery','Nutrition','Nutrition and Dietetics','OB/GYN','Obstetrics',&#xA;'Obstetrics and Gynecology','Occupational Health','Occupational Medicine','Occupational Therapy','Oculoplastics Ophthalmology','Oncology','Oncology Critical Care','Ophthalmology','Ophthalmology Imaging',&#xA;'Optometry','Oral &amp; Maxillofacial Surgery','Oral and Maxillofacial Surgery','Oral Med and Dentistry','Oral Medicine and Oncology','Orthopaedic Oncology','Orthopaedic Surgery','Orthopaedics',&#xA;'Orthopedic Surgery &amp; Sports Medicine','Orthopedics','Orthotics Prosthetics','Otolaryngology','Otology','Otoneurology','Pain Clinic','Pain Medicine','Palliative Care','Palliative Medicine','Pathology',&#xA;'Pediatric Allergy','Pediatric Anesthesia','Pediatric Cardiology','Pediatric Coordinated Care','Pediatric Dermatology','Pediatric Endocrinology','Pediatric Food Allergy','Pediatric Gastroenterology',&#xA;'Pediatric Genetics','Pediatric Hematology and Oncology','Pediatric Hospice and Palliative Medicine','Pediatric Infectious Disease','Pediatric Intensive Care','Pediatric Nephrology','Pediatric Neurology',&#xA;'Pediatric Neurosurgery','Pediatric Nutrition','Pediatric Occupational Therapy','Pediatric Oncology','Pediatric Orthopedics','Pediatric Otolaryngology','Pediatric Physical Medicine and Rehabilitation',&#xA;'Pediatric Psychiatry','Pediatric Psychology Oncology','Pediatric Pulmonology','Pediatric Rheumatology','Pediatric Speech Therapy','Pediatric Surgery','Pediatric Survivorship Program','Pediatric Urology',&#xA;'Pediatrics','Pediatrics/Neonatology','Perinatology','Peripheral Vascular','Peritoneal','Pharmacy','Physical Medicine &amp; Rehabilitation','Physical Medicine and Rehabilitation','Physical Therapy',&#xA;'Plastic Surgery','Podiatry','Postpartum','Pre-Admission Evaluation','Pre-Admission Testing','Primary Care','Psychiatry','Psychologist/Rehabilitation','Psychology','Psychosocial Oncology',&#xA;'Pulmonary Diagnostics','Pulmonary Disease','Pulmonary Rehabilitation','Pulmonology','Pulmonology and Allergy','Radiation Oncology','Radiology','Registration','Registration Avita','Registration Van',&#xA;'Reproductive Endocrinology and Infertility','Research','Respiratory Therapy','Retina Ophthalmology','Retinal Degeneration Ophthalmology','Retinopathy','Rheumatology','Sarcoma and Bone Oncology','SHARED',&#xA;'Sinus','Skilled Nursing Facility','Sleep Medicine','Social Services','Speech Therapy','Spine Surgery','Spiritual Care','Sports Medicine','Sports Medicine and Rehabilitation','Stroke',&#xA;'Surgery Critical Care','Surgical Intensive Care','Surgical Oncology','Surgical Ophthalmology','Survivorship Program','Thoracic Diseases','Thoracic Oncology','Thoracic Surgery','Tobacco Treatment',&#xA;'Transfusion','Transplant','Transplant Hepatology','Transplant Surgery','Trauma Ophthalmology','Trauma Surgery','Travel Medicine','Ultrasound','Urgent Care','Urology','Uveitis and Ocular Immunology',&#xA;'Vascular','Vascular Surgery','Vestibular','Virtual Department','Vision Rehab','Voice &amp; Swallowing','Weight Center','Weight Management Classes','Wellness','Wellness and Prevention','Work Conditioning',&#xA;'Wound Care')&#xA;&#xA;;&#xA;&#xA;--------&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 3&#xA;from [dbo].[FactEncounterEvent_v2] fact&#xA; join dbo.DimEncounterType et&#xA;  on fact.EncounterTypeKey = et.EncounterTypeKey&#xA; join dbo.DimDepartment ds&#xA;  on fact.DepartmentKey = ds.DepartmentKey&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys)&#xA;  and et.EncounterTypeName in ('Telemedicine','Medicare Wellness Telemedicine','E-Visit','EConsults','E-Consult','Anti-coag visit (remote)','Telemedicine Chem','Zoom Video Visit')&#xA;  --and ds.DepartmentSpecialty in ()&#xA;&#xA;;&#xA;--------&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 4&#xA;from [dbo].[FactEncounterEvent_v2] fact&#xA; join dbo.DimEncounterType et&#xA;  on fact.EncounterTypeKey = et.EncounterTypeKey&#xA; join dbo.DimDepartment ds&#xA;  on fact.DepartmentKey = ds.DepartmentKey&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys)&#xA;  and et.EncounterTypeName in ('ABA Evaluation','AMH BH Assessment 60','Anti-coag visit','Anticoagulation Monitoring','Anti-Thrombotic Clinic','BH Initial Assessment','Electrophysiology',&#xA;  'Immunization','Infusion','Infusion Visit','Lab Visit','MFM Consult','Ophth Exam','Pharmacotherapy','PPC ANSA/CANS Assessment','PPC Diagnostic Evaluation','PPC Intramuscular Injection',&#xA;  'PPC Nursing Education/Assessment','PPC Psychological Testing','Pre-Admission','Pre-Admission Testing','Pre-Operative Assessment','Pre-Operative Nurse Assessment','Surgical Consult')&#xA;  --and ds.DepartmentSpecialty in ()&#xA;&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 5&#xA;from [dbo].[FactEncounterEvent_v2] fact&#xA; join dbo.DimEncounterType et&#xA;  on fact.EncounterTypeKey = et.EncounterTypeKey&#xA; join dbo.DimDepartment ds&#xA;  on fact.DepartmentKey = ds.DepartmentKey&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys)&#xA;  and et.EncounterTypeName in ('Telemed Clin Support','Telemed Clin Support Chem')&#xA;  --and ds.DepartmentSpecialty in ()&#xA;&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 6&#xA;from [dbo].[FactEncounterEvent_v2] fact&#xA; join dbo.DimEncounterType et&#xA;  on fact.EncounterTypeKey = et.EncounterTypeKey&#xA; join dbo.DimDepartment ds&#xA;  on fact.DepartmentKey = ds.DepartmentKey&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys)&#xA;  and et.EncounterTypeName in ('Canceled','Cardiology Conference','EHS System Generated','HFH System Generated','Home Health Resumption of Care Planning','MRMC System Generated','Nail Trim',&#xA;  'One Medical System Generated')&#xA;  --and ds.DepartmentSpecialty in ()&#xA;&#xA;;&#xA;--------&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;from [dbo].[FactEncounterEvent_v2] fact&#xA; join dbo.DimEncounterType et&#xA;  on fact.EncounterTypeKey = et.EncounterTypeKey&#xA; join dbo.DimDepartment ds&#xA;  on fact.DepartmentKey = ds.DepartmentKey&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys)&#xA;  and et.EncounterTypeName in ('ABA Treatment','Afib Clinic','After Hours Office Visit','AMH Nurse Visit','Ancillary Procedure','Bariatric Surgery Office Visit','BH Follow up','Cardio-Oncology Clinic',&#xA;  'Center on Aging Follow up','Center on Aging Initial Eval','Clinical Support Encounter Chem','CV Adult Congenital','CV Athletic Clinic','CV Genetic Clinic','CV HFC Clinic','Evaluation','Follow-Up',&#xA;  'Genetics Office Visit','Hospice Admission','Hypertension Clinic','iCMP Pharmacy','Individual Psychotherapy 30','Individual Psychotherapy 45','Individual Psychotherapy 60','Initial consult','Initial Prenatal',&#xA;  'Intake','IVC Filter Clinic','Lactation Encounter','Lipid Clinic','MDC Follow Up','MDC Initital Consult','MDC Office Visit','Medicare Wellness','Neuro MDC-Post Covid Clinic','Nurse Only',&#xA;  'Nursing Home/Home/Unscheduled Visit','Nutrition','Occupational Health','Occupational Therapy Visit','Office Visit Unscheduled','On-Site Wellness','Outpatient Surgery','Pace Day Center','Pain Consult Follow Up',&#xA;  'Pain Consult New Patient','Park Center DCS Encounter','Park Center Encounter','Ped Follow up','Ped New Patient','PHI Cardio Metabolic Clinic','Physical Therapy Visit','Postpartum Visit','POTS Clinic','PPC BPHC',&#xA;  'PPC Family ADL Skills','PPC Family Team Meeting','PPC Family Therapy w Family','PPC Family Therapy w/o Family','PPC GROUP ADL SKILLS TRAINING','PPC Group Home','PPC Group Therapy','PPC Individual Therapy 30',&#xA;  'PPC Individual Therapy 45','PPC Individual Therapy 60','PPC INTENSIVE OP PROGRAM','PPC Nurse Visit','PPC Psych New Client 30','PPC Psych New Client 60','PPC Psych Office Visit 30','PPC Walk In','PPCPsych Office Visit 60',&#xA;  'Prenatal Follow Up Visit','Prenatal Initial Visit','Prep for Procedure','Procedure visit','Pulmonary Hypertension Clinic','Rad Onc Procedure Visit','Radiation Completion Encounter','Referral Consult',&#xA;  'Rehab Services Visit','Routine Prenatal','Same Day','Short Term Follow Up','Speech Therapy Visit','Surgery','Travel Medicine','Treatment','Valve Clinic','Vascular Clinic','Walk In','Walk-In','Women''s OB Heart Clinic')&#xA;  --and ds.DepartmentSpecialty in ()&#xA;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;from [dbo].[FactEncounterEvent_v2] fact&#xA; join dbo.DimEncounterType et&#xA;  on fact.EncounterTypeKey = et.EncounterTypeKey&#xA; join dbo.DimDepartment ds&#xA;  on fact.DepartmentKey = ds.DepartmentKey&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys)&#xA;  and et.EncounterTypeName in ('CV Health and Wellness','Medication Assistance','Prep for Surgery','Safety Pin')&#xA;  --and ds.DepartmentSpecialty in ()&#xA;&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 9&#xA;from [dbo].[FactEncounterEvent_v2] fact&#xA; join dbo.DimEncounterType et&#xA;  on fact.EncounterTypeKey = et.EncounterTypeKey&#xA; join dbo.DimDepartment ds&#xA;  on fact.DepartmentKey = ds.DepartmentKey&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys)&#xA;  and et.EncounterTypeName in ('NST','PPC CMHI','PPC DCS Services','PPC Individual ADL Skills','Travel','Unknown')&#xA;  --and ds.DepartmentSpecialty in ()&#xA;&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 2&#xA;from [dbo].[FactEncounterEvent_v2] fact&#xA; join dbo.DimEncounterType et&#xA;  on fact.EncounterTypeKey = et.EncounterTypeKey&#xA; join dbo.DimDepartment ds&#xA;  on fact.DepartmentKey = ds.DepartmentKey&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys)&#xA;  and et.EncounterTypeName in ('Patient Message','Patient Outreach','Telemedicine - audio only','Telephone','Telephone Routine Follow-Up')&#xA;  --and ds.DepartmentSpecialty in ()&#xA;&#xA;;&#xA;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;from [dbo].[FactEncounterEvent_v2] fact&#xA; join dbo.DimEncounterType et&#xA;  on fact.EncounterTypeKey = et.EncounterTypeKey&#xA; join dbo.DimDepartment ds&#xA;  on fact.DepartmentKey = ds.DepartmentKey&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys)&#xA;  and et.EncounterTypeName in ('AC Results','Advance Care Planning (ACP)','CAHPS Survey Testing','Case Management','CC Care Coordination','Clinical Support Encounter','E-Consult Community Order','Enrollment',&#xA;  'Interpretation','LAA-Closure Device','Order Transcription','Plan of Care Documentation','Pop Health Care Coordination','Pop Health Pharmacy','PPC Care Coordination','PPC Case Management Therapy',&#xA;  'PPC Drug Testing','PPC Eagle Employment','PRC Note','Questionnaire Series Submission','Recurring Plan','Research Encounter','Social Care Enrollment','Social Work','Transcribe Orders (Cadence Only)',&#xA;  'Tumor Board Conference','Womens &amp; Childrens Bereavement Coordinator','Women''s and Children''s Navigation')&#xA;  --and ds.DepartmentSpecialty in ()&#xA;&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;from [dbo].[FactEncounterEvent_v2] fact&#xA; join dbo.DimEncounterType et&#xA;  on fact.EncounterTypeKey = et.EncounterTypeKey&#xA; join dbo.DimDepartment ds&#xA;  on fact.DepartmentKey = ds.DepartmentKey&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys)&#xA;  and et.EncounterTypeName in ('Oncology Nutritional Documentation')&#xA;  --and ds.DepartmentSpecialty in ()&#xA;&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 7&#xA;from [dbo].[FactEncounterEvent_v2] fact&#xA; join dbo.DimEncounterType et&#xA;  on fact.EncounterTypeKey = et.EncounterTypeKey&#xA; join dbo.DimDepartment ds&#xA;  on fact.DepartmentKey = ds.DepartmentKey&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys)&#xA;  and et.EncounterTypeName in ('Office Visit')&#xA;  --and ds.DepartmentSpecialty in ()&#xA;&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;from [dbo].[FactEncounterEvent_v2] fact&#xA; join dbo.DimEncounterType et&#xA;  on fact.EncounterTypeKey = et.EncounterTypeKey&#xA; join dbo.DimDepartment ds&#xA;  on fact.DepartmentKey = ds.DepartmentKey&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys)&#xA;  and et.EncounterTypeName in ('AC Pharmacy Question')&#xA;  --and ds.DepartmentSpecialty in ()&#xA;&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 1&#xA;from [dbo].[FactEncounterEvent_v2] fact&#xA; join dbo.DimEncounterType et&#xA;  on fact.EncounterTypeKey = et.EncounterTypeKey&#xA; join dbo.DimDepartment ds&#xA;  on fact.DepartmentKey = ds.DepartmentKey&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys)&#xA;  and et.EncounterTypeName in ('Testing','Pre-op/Pre-procedure Orders')&#xA;  --and ds.DepartmentSpecialty in ()&#xA;--&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 2&#xA;from [dbo].[FactEncounterEvent_v2] fact&#xA; join dbo.DimEncounterType et&#xA;  on fact.EncounterTypeKey = et.EncounterTypeKey&#xA; join dbo.DimDepartment ds&#xA;  on fact.DepartmentKey = ds.DepartmentKey&#xA;where &#xA;--fact.VisitCategoryKey is null&#xA;  --and &#xA;  et.EncounterTypeName in ('Family Therapy WO Patient')&#xA;  --and ds.DepartmentSpecialty in ()&#xA;--&#xA;;&#xA;&#xA;update [dbo].[FactEncounterEvent_v2] set VisitCategoryKey = 8&#xA;from [dbo].[FactEncounterEvent_v2] fact&#xA; join dbo.DimEncounterType et&#xA;  on fact.EncounterTypeKey = et.EncounterTypeKey&#xA; join dbo.DimDepartment ds&#xA;  on fact.DepartmentKey = ds.DepartmentKey&#xA;where EncounterKey in (select distinct(EncounterKey) from #EncounterKeys)&#xA; -- and et.EncounterTypeName in ('AC Pharmacy Question')&#xA;  --and ds.DepartmentSpecialty in ()&#xA;--&#xA;;&#xA;" xmlns:SQLTask="www.microsoft.com/sqlserver/dts/tasks/sqltask" />
      </DTS:ObjectData>
    </DTS:Executable>
  </DTS:Executables>
  <DTS:PrecedenceConstraints>
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 10]"
      DTS:CreationName=""
      DTS:DTSID="{3B7B5FF2-9A1B-425B-AF0C-7196E20F66E3}"
      DTS:From="Package\Set Visit Category Types part 1a"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 10"
      DTS:To="Package\Set Visit Category Types part 1b" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 11]"
      DTS:CreationName=""
      DTS:DTSID="{8CDBF4FA-52E5-49CD-AC33-1168E2E39AA1}"
      DTS:From="Package\Set Visit Category Types part 2a"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 11"
      DTS:To="Package\Set Visit Category Types part 2b" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 12]"
      DTS:CreationName=""
      DTS:DTSID="{D22FC559-D102-44DA-9D64-9939563E4395}"
      DTS:From="Package\Set Visit Category Types part 3a"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 12"
      DTS:To="Package\Set Visit Category Types part 3b" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 13]"
      DTS:CreationName=""
      DTS:DTSID="{55641088-4952-442A-B52E-7E4F041D5FFC}"
      DTS:From="Package\Set Visit Category Types part 1b"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 13"
      DTS:To="Package\Set Visit Category Types part 2a" />
    <DTS:PrecedenceConstraint
      DTS:refId="Package.PrecedenceConstraints[Constraint 14]"
      DTS:CreationName=""
      DTS:DTSID="{F94CF032-71B1-4319-97AA-7D6A564CC80A}"
      DTS:From="Package\Set Visit Category Types part 2b"
      DTS:LogicalAnd="True"
      DTS:ObjectName="Constraint 14"
      DTS:To="Package\Set Visit Category Types part 3a" />
  </DTS:PrecedenceConstraints>
  <DTS:DesignTimeProperties><![CDATA[<?xml version="1.0"?>
<!--This CDATA section contains the layout information of the package. The section includes information such as (x,y) coordinates, width, and height.-->
<!--If you manually edit this section and make a mistake, you can delete it. -->
<!--The package will still be able to load normally but the previous layout information will be lost and the designer will automatically re-arrange the elements on the design surface.-->
<Objects
  Version="8">
  <!--Each node below will contain properties that do not affect runtime behavior.-->
  <Package
    design-time-name="Package">
    <LayoutInfo>
      <GraphLayout
        Capacity="16" xmlns="clr-namespace:Microsoft.SqlServer.IntegrationServices.Designer.Model.Serialization;assembly=Microsoft.SqlServer.IntegrationServices.Graph" xmlns:mssgle="clr-namespace:Microsoft.SqlServer.Graph.LayoutEngine;assembly=Microsoft.SqlServer.Graph" xmlns:assembly="http://schemas.microsoft.com/winfx/2006/xaml">
        <NodeLayout
          Size="231,42"
          Id="Package\Set Visit Category Types part 1a"
          TopLeft="202,29" />
        <NodeLayout
          Size="230,42"
          Id="Package\Set Visit Category Types part 1b"
          TopLeft="200,90" />
        <NodeLayout
          Size="225,42"
          Id="Package\Set Visit Category Types part 2a"
          TopLeft="188,165" />
        <NodeLayout
          Size="231,42"
          Id="Package\Set Visit Category Types part 2b"
          TopLeft="185,236" />
        <NodeLayout
          Size="231,42"
          Id="Package\Set Visit Category Types part 3a"
          TopLeft="177,321" />
        <NodeLayout
          Size="225,42"
          Id="Package\Set Visit Category Types part 3b"
          TopLeft="172,391" />
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 10]"
          TopLeft="202,50">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-2,61"
              Start="0,0"
              End="-9.5,61">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="-20.5,0" />
                  <mssgle:CubicBezierSegment
                    Point1="-20.5,0"
                    Point2="-24.5,0"
                    Point3="-24.5,4" />
                  <mssgle:LineSegment
                    End="-24.5,57" />
                  <mssgle:CubicBezierSegment
                    Point1="-24.5,57"
                    Point2="-24.5,61"
                    Point3="-20.5,61" />
                  <mssgle:LineSegment
                    End="-9.5,61" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 11]"
          TopLeft="300.5,207">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="0,29"
              Start="0,0"
              End="0,21.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,21.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 12]"
          TopLeft="292.5,363">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-8,28"
              Start="0,0"
              End="-8,20.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,10" />
                  <mssgle:CubicBezierSegment
                    Point1="0,10"
                    Point2="0,14"
                    Point3="-4,14" />
                  <mssgle:LineSegment
                    End="-4,14" />
                  <mssgle:CubicBezierSegment
                    Point1="-4,14"
                    Point2="-8,14"
                    Point3="-8,18" />
                  <mssgle:LineSegment
                    End="-8,20.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 13]"
          TopLeft="315,132">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-14.5,33"
              Start="0,0"
              End="-14.5,25.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,12.5" />
                  <mssgle:CubicBezierSegment
                    Point1="0,12.5"
                    Point2="0,16.5"
                    Point3="-4,16.5" />
                  <mssgle:LineSegment
                    End="-10.5,16.5" />
                  <mssgle:CubicBezierSegment
                    Point1="-10.5,16.5"
                    Point2="-14.5,16.5"
                    Point3="-14.5,20.5" />
                  <mssgle:LineSegment
                    End="-14.5,25.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <EdgeLayout
          Id="Package.PrecedenceConstraints[Constraint 14]"
          TopLeft="300.5,278">
          <EdgeLayout.Curve>
            <mssgle:Curve
              StartConnector="{assembly:Null}"
              EndConnector="-8,43"
              Start="0,0"
              End="-8,35.5">
              <mssgle:Curve.Segments>
                <mssgle:SegmentCollection
                  Capacity="5">
                  <mssgle:LineSegment
                    End="0,17.5" />
                  <mssgle:CubicBezierSegment
                    Point1="0,17.5"
                    Point2="0,21.5"
                    Point3="-4,21.5" />
                  <mssgle:LineSegment
                    End="-4,21.5" />
                  <mssgle:CubicBezierSegment
                    Point1="-4,21.5"
                    Point2="-8,21.5"
                    Point3="-8,25.5" />
                  <mssgle:LineSegment
                    End="-8,35.5" />
                </mssgle:SegmentCollection>
              </mssgle:Curve.Segments>
            </mssgle:Curve>
          </EdgeLayout.Curve>
          <EdgeLayout.Labels>
            <EdgeLabelCollection />
          </EdgeLayout.Labels>
        </EdgeLayout>
        <AnnotationLayout
          Text="Originally this was part of the FactEncounterEvents_V2 load, but it takes quite a while to execute the SQL. Run times are as follows:&#xA;1a - 1.5 hrs&#xA;1b - 37 mins&#xA;2a - 1 hr&#xA;2b - 1.25 hrs&#xA;3a - 50 mins&#xA;3b - 30 mins&#xA;&#xA;in total that's around 6 hours.&#xA;this should evecute after all clients have data loaded for the month, however if it is run before that, it won't have an impact as the &#xA;sql just updates non-nulls."
          ParentId="Package"
          FontInfo="{assembly:Null}"
          Size="716,200"
          Id="5b3ec830-b1ca-4ee9-81c6-03b65b33758f"
          TopLeft="628,163" />
      </GraphLayout>
    </LayoutInfo>
  </Package>
  <ConnectionManager
    design-time-name="Package.ConnectionManagers[asazure://westus.asazure.windows.net/azwphaas01.POC]">
    <ProjectReferenceName></ProjectReferenceName>
  </ConnectionManager>
</Objects>]]></DTS:DesignTimeProperties>
</DTS:Executable>